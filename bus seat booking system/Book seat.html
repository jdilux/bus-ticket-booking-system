<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css">

        <title>Abirami Travels | Homepage</title>

        <style>
            body {
                font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
                background-color: whitesmoke;
                box-sizing: border-box;
                min-height: 100vh;
				display: grid;

				--bkg: #5eb3fd;
				--white: #e7e6e6;

				background-color: var(--white);
				background-image: url("https://www.transparenttextures.com/patterns/concrete-wall.png");
                margin: 0;
                padding: 0;
            }

            .container-head {
				width: 100%;
				height: 100%;
				display: grid;
				place-items: center;
				overflow: hidden;
			}

			.title {
				position: absolute;
				top: 25%;
				left: 50%;
				transform: translate(-50%, -50%);
			}

			.title h1 {
				font-size: 25vmin;
				font-weight: 900;
				color: #4CAF50;
			}

			/* Define styles for the bus */
			.bus {
				width: 20vmin;
				height: 12vmin;
				background-color: var(--white);
				background-image: url("https://www.transparenttextures.com/patterns/concrete-wall.png");
				border-radius: 100% / 70% 70% 70% 70%;
				transform: translateX(100em) rotate(45deg); /* Rotate 45 degrees clockwise */
				position: relative;
				opacity: 0.9;
				mix-blend-mode: exclusion;
				animation: busMove 4s ease-out infinite;
			}

			/* Define the bus animation */
			@keyframes busMove {
				0% {
					transform: translateX(30em) rotate(0deg);
				}
				100% {
					transform: translateX(-35em) rotate(0deg);
				}
			}

			/* Add a container for the bus image */
			.bus-container {
				position: absolute;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
				overflow: hidden;
			}

			/* Style the bus image */
			.bus-container img {
				width: 100%;
				height: 100%;
				object-fit: cover; /* Ensure the image covers the entire container */
			}
        
            .topnav {
                background-color: #333;
                overflow: hidden;
                margin-bottom: 70px;
            }
        
            .topnav a {
                float: left;
                color: #f2f2f2;
                text-align: center;
                padding: 14px 16px;
                text-decoration: none;
                font-size: 17px;
            }
            
            .topnav a:hover {
                background-color: #ddd;
                color: black;
            }
            
            .topnav a.active {
                background-color: #4CAF50;
                color: white;
            }

            #profile-icon {
                position: fixed;
                top: 5px;
                right: 10px;
                width: 40px;
                height: 40px;
                background-color: #ccc;
                border-radius: 50%;
                cursor: pointer;
                display: flex;
                justify-content: center;
                align-items: center;
                font-size: 20px; /* Adjust the font size as needed */
            }
            
            /* CSS for the modal dialog */
            #modal-overlay {
                display: none;
                position: fixed;
                top: 60px;
                right: 10px;
                width: fit-content;
                background-color: #fff;
                border: 1px solid #ccc;
                border-radius: 10px;
                box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.2);
                padding: 10px;
            }

            h1 {
                line-height: 0;
                text-align: center;
                margin-top: 50px;
                font-size: 100pt;
                padding-top: 30px;
                padding-bottom: 10px;
                color: #4CAF50;
            }

            h2 {
                padding-left: 40px;
                text-align: center;
                margin-top: 30px;
                margin-bottom: 5px;
                font-size: 40pt;
                letter-spacing: 70px;
                font-weight: 1000;
            }

            h3 {
                text-align: center;
                margin-top: 40px;
                margin-bottom: 5px;
                font-size: 50pt;
            }

            h5 {
                text-align: center;
                font-size: 20pt;
            }
            
            form {
                margin-top: 10px;
                margin-bottom: 50px;
                margin-left: auto;
                margin-right: auto;
                padding: 20px;
                padding-left: 30px;
                padding-right: 30px;
                width: 600px;
                background-color: #fff;
                box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
                border-radius: 10px;
            }

            label {
                display: block;
                margin-top: 20px;
                font-size: 18px;
                font-weight: bold;
                color: #333;
            }
            
            input, select {
                display: block;
                width: 100%;
                padding: 10px;
                border: none;
                border-radius: 5px;
                background-color: #f2f2f2;
                font-size: 16px;
                color: #666;
                box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
            }

            input[type="submit"] {
                display: inline-block;
                text-align: center;
                width: 400px;
                margin: 10px;
                font-size: 15pt;
                margin-top: 30px;
                margin-bottom: 40px;
                background-color: #4CAF50;
                color: black;
                text-decoration: none;
                border-style: none;
                border-radius: 5px;
            }

            input[type="submit"]:hover {
                cursor: pointer;
                background-color: black;
                color: white;
            }

            .centered {
                display: flex;
                justify-content: center;
                align-items: center;
                height: 100vh;
            }

            .seat-map {
                font-family: Arial, sans-serif;
                width: 400px;       
                background-color: white;     
            }

            .row {
                display: flex;
                justify-content: space-between;
                margin-bottom: 10px;
            }

            .left-side {
                flex-grow: 0;
            }

            .right-side {
                flex-grow: 10;
                text-align: right;
            }

            .seat {
                display: inline-block;
                width: 50px;
                height: 30px;
                border: 1px solid black;
                text-align: center;
                line-height: 30px;
            }

            .driver-seat {
                background-color: #808080;
            }

            .door {
                background-color: #808080;
            }

            .container-map {
                text-align: center;
                max-width: 1200px;
                margin: 0 auto;
                padding: 0 20px;
            }

            .btn-con {
                text-align: center;
            }

            footer {
                background-color: #333;
                color: #fff;
                padding: 30px 0;
                font-size: 14px;
            }

            .container-footer {
                text-align: left;
                max-width: 1200px;
                margin: 0 auto;
                padding: 0 auto;
            }

            .row {
                display: flex;
                flex-wrap: wrap;
            }

            .col {
                flex: 1;
                margin: 0 20px;
            }

            h3 {
                font-size: 18px;
                margin-bottom: 20px;
            }

            p {
                margin-bottom: 20px;
            }

            .social-icons {
                list-style: none;
                margin: 0;
                padding: 0;
                display: flex;
            }

            .social-icons li {
                margin-right: 10px;
            }

            .social-icons li a {
                display: block;
                width: 30px;
                height: 30px;
                background-color: #fff;
                text-align: center;
                line-height: 30px;
                border-radius: 50%;
            }

            .social-icons li a:hover {
                background-color: #f2f2f2;
            }

            .fa {
                color: #333;
                font-size: 16px;
            }
        </style>
    </head>

    <body>
        <div class="topnav">
            <a class="active" href="Home.html">Home</a>
            <a href="Payment.html">Payment</a>
            <a href="Contact us.html">Contact Us</a>
        </div>

        <!-- Profile icon with a face icon inside -->
        <div id="profile-icon">
            <i class="fas fa-user"></i>
        </div>

        <!-- Modal overlay -->
        <div id="modal-overlay"></div>
        
        <div class="container-head">
			<div class="title">
				<h1>ABIRAMI</h1>
               
			</div>
			<div class="bus">
				<div class="bus-container">
					<!-- Replace the bus image URL with your own -->
					<img src="bus_image_url.png" alt="Bus Image">
				</div>
			</div>
		</div>

        <h2>TRAVELS</h2>
        <h5>Book your bus tickets online with ease and convenience.</h5>

        <form onsubmit="return validateForm();" method="post" action="Book_seat_Database.php">	
            <label for="from">From:</label>
            <select id="From" name="From">
                <option value="">--Select--</option>
                <option value="Jaffna">Jaffna</option>
                <option value="Badulla">Badulla</option>
                <option value="Colombo">Colombo</option>
                <option value="Galle">Galle</option>
            </select>
            
            <label for="to">To:</label>
            <select id="TO" name="TO">
                <option value="">--Select--</option>
                <option value="Jaffna">Jaffna</option>
                <option value="Badulla">Badulla</option>
                <option value="Colombo">Colombo</option>
                <option value="Galle">Galle</option>
            </select>

            <label for="date">Date of Travel:</label>
            <input type="date" id="date" name="date">
            
            <label for="time">Time of Travel:</label>
            <select id="time" name="time">
                <option value="">--Select time--</option>
            </select>
            
            <label for="no-of-seats">Number of Seats:</label>
            <select id="no-of-seats" name="no-of-seats">
                <option value="">-- Select Number of Seats --</option>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
                <option value="7">7</option>
                <option value="8">8</option>
                <option value="9">9</option>
            </select>

            <label for="seat">Select seat:</label>

            <div class="container-map">
                <div class="centered">
                    <div class="seat-map">
                        <div class="row">
                            <div class="left-side">
                                <div class="seat door unselectable">Door</div>
                            </div>
                            <div class="right-side">
                                <div class="seat driver-seat unselectable">Driver</div>
                            </div>
                        </div>                        
        
                        <div class="row">
                            <div class="left-side">
                                <div class="seat">A1</div>
                                <div class="seat">A2</div>
                            </div>
                            <div class="right-side">
                                <div class="seat">B1</div>
                                <div class="seat">B2</div>
                            </div>
                        </div>
        
                        <div class="row">
                            <div class="left-side">
                                <div class="seat">C1</div>
                                <div class="seat">C2</div>
                            </div>
                            <div class="right-side">
                                <div class="seat">D1</div>
                                <div class="seat">D2</div>
                            </div>
                        </div>
        
                        <div class="row">
                            <div class="left-side">
                                <div class="seat">E1</div>
                                <div class="seat">E2</div>
                            </div>
                            <div class="right-side">
                                <div class="seat">F1</div>
                                <div class="seat">F2</div>
                            </div>
                        </div>
        
                        <div class="row">
                            <div class="left-side">
                                <div class="seat">G1</div>
                                <div class="seat">G2</div>
                            </div>
                            <div class="right-side">
                                <div class="seat">H1</div>
                                <div class="seat">H2</div>
                            </div>
                        </div>
        
                        <div class="row">
                            <div class="left-side">
                                <div class="seat">I1</div>
                                <div class="seat">I2</div>
                            </div>
                            <div class="right-side">
                                <div class="seat">J1</div>
                                <div class="seat">J2</div>
                            </div>
                        </div>
        
                        <div class="row">
                            <div class="left-side">
                                <div class="seat">K1</div>
                                <div class="seat">K2</div>
                            </div>
                            <div class="right-side">
                                <div class="seat">L1</div>
                                <div class="seat">L2</div>
                            </div>
                        </div>
        
                        <div class="row">
                            <div class="left-side">
                                <div class="seat">M1</div>
                                <div class="seat">M2</div>
                            </div>
                            <div class="right-side">
                                <div class="seat">N1</div>
                                <div class="seat">N2</div>
                            </div>
                        </div>
        
                        <div class="row">
                            <div class="left-side">
                                <div class="seat">O1</div>
                                <div class="seat">O2</div>
                            </div>
                            <div class="right-side">
                                <div class="seat">P1</div>
                                <div class="seat">P2</div>
                            </div>
                        </div>
        
                        <div class="row">
                            <div class="left-side">
                                <div class="seat">Q1</div>
                                <div class="seat">Q2</div>
                            </div>
                            <div class="right-side">
                                <div class="seat">R1</div>
                                <div class="seat">R2</div>
                            </div>
                        </div>
        
                        <div class="row">
                            <div class="left-side">
                                <div class="seat">S1</div>
                                <div class="seat">S2</div>
                            </div>
                            <div class="right-side">
                                <div class="seat">T1</div>
                                <div class="seat">T2</div>
                            </div>
                        </div>
        
                        <div class="row">
                            <div class="left-side">
                                <div class="seat">U1</div>
                                <div class="seat">U2</div>
                            </div>
                            <div class="right-side">
                                <div class="seat">V1</div>
                                <div class="seat">V2</div>
                            </div>
                        </div>
        
                        <div class="row">
                            <div class="left-side">
                                <div class="seat">W1</div>
                                <div class="seat">W2</div>
                            </div>
                            <div class="right-side">
                                <div class="seat">X1</div>
                                <div class="seat">X2</div>
                            </div>
                        </div>
        
                        <div class="row">
                            <div class="left-side">
                                <div class="seat">Y1</div>
                                <div class="seat">Y2</div>
                            </div>
                            <div class="right-side">
                                <div class="seat">Z1</div>
                                <div class="seat">Z2</div>
                            </div>
                        </div>
                    </div> 
                </div>   

                <label for="totalPrice" id="totalPrice">Total Price: Rs. 0</label>

                <!-- Add a hidden input field to store the selected seat -->
                <input type="hidden" id="selectedSeat" name="selectedSeat" value="">
                <input type="hidden" id="ticketPrice" name="ticketPrice" value="">

                <input type="submit" value="Book seat">    
            </div>
        </form>

        <script>
            // JavaScript to handle the profile icon click event
            const profileIcon = document.getElementById('profile-icon');
            const modalOverlay = document.getElementById('modal-overlay');
            
            let isModalOpen = false;

            profileIcon.addEventListener('click', () => {
                const urlParams = new URLSearchParams(window.location.search);
                const username = urlParams.get('username');

                if (username) {
                    if (!isModalOpen) {
                        // Display the modal dialog with the username and "Settings" option
                        modalOverlay.innerHTML = `
                            <p>Welcome, ${username}!</p>
                            <p><a href="#" id="settings-link">Settings</a></p>
                        `;
                        modalOverlay.style.display = 'block';
                        isModalOpen = true;

                        // Handle the click event for the "Settings" link inside the modal dialog
                        const settingsLink = document.getElementById('settings-link');
                        settingsLink.addEventListener('click', (e) => {
                            e.preventDefault(); // Prevent the default link behavior
                            // Redirect to the settings page or perform any desired action
                            alert("Redirecting to Settings Page"); // You can replace this with your actual settings page URL
                        });
                    } else {
                        // Close the modal dialog
                        modalOverlay.style.display = 'none';
                        isModalOpen = false;
                    }
                } else {
                    alert("Username not found in URL.");
                }
            });

            // Close the modal dialog when clicking anywhere on the web page
            document.body.addEventListener('click', (e) => {
                if (isModalOpen && e.target !== profileIcon && e.target !== modalOverlay) {
                    modalOverlay.style.display = 'none';
                    isModalOpen = false;
                }
            });

            function validateForm() {
                var fromSelect = document.getElementById("From");
                var toSelect = document.getElementById("TO");
                var dateInput = document.getElementById("date");
                var timeSelect = document.getElementById("time");
                var noOfSeats = document.getElementById("no-of-seats");
                var selectedSeat = document.getElementById("selectedSeat");

                // Check if "From" and "To" selections are the same
                if (fromSelect.value === toSelect.value) {
                    alert("Please select 'From' and 'To' locations!");
                    return false; // Prevent form submission
                }

                // Check if date and time are selected
                if (dateInput.value === "") {
                    alert("Please select a date of travel!");
                    return false; // Prevent form submission
                }

                if (timeSelect.value === "") {
                    alert("Please select a time of travel!");
                    return false; // Prevent form submission
                }

                if (timeSelect.value === "No buses available for today") {
                    alert("Today there are no buses for your selected destination! Please select another date.");
                    return false; // Prevent form submission
                }

                // Check if the number of seats is selected
                if (noOfSeats.value === "") {
                    alert("Please select the number of seats!");
                    return false; // Prevent form submission
                }

                // Check if the seats are selected or not
                if (selectedSeat.value === "") {
                    alert("Please select a seat to continue!");
                    return false; // Prevent form submission
                }

            // Form is valid, allow submission
            return true;
            }
        
            window.addEventListener('DOMContentLoaded', function () {
                var fromSelect = document.getElementById("From");
                var toSelect = document.getElementById("TO");
                var noOfSeatsSelect = document.getElementById("no-of-seats");

                // Initial options for the "To" dropdown
                var initialToOptions = toSelect.innerHTML;

                // Function to calculate the total ticket price
                function calculateTotalPrice() {
                    var selectedDestination = toSelect.value;
                    var selectedSeats = parseInt(noOfSeatsSelect.value);

                    // Get the ticket price for the selected destination
                    var ticketPrice = ticketPrices[selectedDestination];

                    // Calculate the total price
                    var totalPrice = ticketPrice * selectedSeats;

                    // Display the total price to the user
                    var totalPriceDisplay = document.getElementById("totalPrice");
                    totalPriceDisplay.innerText = "Total Price: Rs. " + totalPrice;
                }

                fromSelect.addEventListener('change', function () {
                    var selectedFrom = fromSelect.value;

                    // Restore the initial options in the "To" dropdown
                    toSelect.innerHTML = initialToOptions;

                    // Remove the selected option from the "To" dropdown
                    var selectedOption = document.querySelector('#TO option[value="' + selectedFrom + '"]');
                    if (selectedOption) {
                        selectedOption.remove();
                    }

                    // Calculate the total price when the "From" selection changes
                    calculateTotalPrice();
                });

                // Add an event listener to the "Number of Seats" select element
                noOfSeatsSelect.addEventListener("change", calculateTotalPrice);
            });


            window.addEventListener('DOMContentLoaded', function() {
                var dateInput = document.getElementById("date");
                var currentDate = new Date();
                var tomorrowDate = new Date();
                var dayAfterTomorrowDate = new Date();

                // Calculate dates for tomorrow and the day after tomorrow
                tomorrowDate.setDate(currentDate.getDate() + 1);
                dayAfterTomorrowDate.setDate(currentDate.getDate() + 2);

                // Format the dates as yyyy-mm-dd for input's min and max attributes
                var minDate = currentDate.toISOString().split('T')[0];
                var maxDate = dayAfterTomorrowDate.toISOString().split('T')[0];

                dateInput.setAttribute("min", minDate);
                dateInput.setAttribute("max", maxDate);
            });

            // Define departure times for each destination
            var departureTimes = {
                "Jaffna": ["08:00 AM", "10:30 AM", "02:00 PM"],
                "Badulla": ["09:15 AM", "12:45 PM", "03:30 PM"],
                "Colombo": ["07:30 AM", "11:00 AM", "01:45 PM"],
                "Galle": ["08:45 AM", "11:15 AM", "03:15 PM"]
            };
  
            // Function to filter departure times for today
            function filterDepartureTimes() {
                var selectedDestination = document.getElementById("TO").value;
                var dateInput = document.getElementById("date");
                var currentDate = new Date();
                var selectedDate = new Date(dateInput.value);

                var timeSelect = document.getElementById("time");
                timeSelect.innerHTML = "";

                if (selectedDate.getDate() === currentDate.getDate()) {
                    var currentTime = currentDate.getHours() * 60 + currentDate.getMinutes();
                    var filteredTimes = departureTimes[selectedDestination].filter(function (time) {
                        var [hour, minute] = time.split(":");
                        var departureTime = parseInt(hour) * 60 + parseInt(minute);
                        return departureTime > currentTime;
                    });

                    if (filteredTimes.length === 0) {
                        // No buses available for today
                        var option = document.createElement("option");
                        option.text = "No buses available for today";
                        timeSelect.add(option);
                    } else {
                        for (var i = 0; i < filteredTimes.length; i++) {
                            var option = document.createElement("option");
                            option.text = filteredTimes[i];
                            timeSelect.add(option);
                        }
                    }
                } else {
                    for (var i = 0; i < departureTimes[selectedDestination].length; i++) {
                        var option = document.createElement("option");
                        option.text = departureTimes[selectedDestination][i];
                        timeSelect.add(option);
                    }
                }
            }

            // Add an event listener to the date input to update departure times when the date changes
            var dateInput = document.getElementById("date");
            dateInput.addEventListener("change", filterDepartureTimes);

            // Add click event listeners to the seats
            const seats = document.querySelectorAll('.seat');

            seats.forEach(seat => {
                seat.addEventListener('click', () => {
                    if (!seat.classList.contains('unselectable')) {
                        seat.classList.toggle('selected');
                    }
                });
            });

            // Initialize an array to store selected seats
            var selectedSeats = [];

            // Add a click event listener to each seat
            var seatsNo = document.querySelectorAll(".seat");
            seatsNo.forEach(function(seat) {
                seat.addEventListener("click", function() {
                    // Get the seat name
                    var seatName = this.innerText;

                    // Get the selected seat count from the dropdown
                    var selectedSeatCount = parseInt(document.getElementById("no-of-seats").value);

                    // Check if the selected seat count has been reached
                    if (selectedSeats.length < selectedSeatCount) {
                        // Check if the seat is not already selected
                        if (selectedSeats.indexOf(seatName) === -1) {
                            // Add the seat to the selectedSeats array
                            selectedSeats.push(seatName);
                            seat.style.backgroundColor = "green";
                        }
                    } 
                    else {
                        alert("You have already selected the maximum number of seats.");
                    }

                    // Update a hidden input field with selected seats
                    document.getElementById("selectedSeat").value = selectedSeats.join(', ');
                });
            });

            var ticketPrices = {
                "Jaffna": 2400,    // Adjust the prices as needed
                "Badulla": 2250,
                "Colombo": 2300,
                "Galle": 2850
            };
/*
            // Calculate the ticket price based on the selected destination
            var selectedDestination = toSelect.value;
            var price = ticketPrices[selectedDestination];
            if (!price) {
                alert("Invalid destination selected!");
                return false; // Prevent form submission
            }

            ticketPriceInput.value = price;

            var noOfSeatsSelect = document.getElementById("no-of-seats");
            noOfSeatsSelect.addEventListener("change", calculateTotalPrice);

            function calculateTotalPrice() {
                var selectedDestination = document.getElementById("TO").value;
                var selectedSeats = parseInt(document.getElementById("no-of-seats").value);
                
                // Get the ticket price for the selected destination
                var ticketPrice = ticketPrices[selectedDestination];
                
                // Calculate the total price
                var totalPrice = ticketPrice * selectedSeats;
                
                // Display the total price to the user
                var totalPriceDisplay = document.getElementById("totalPrice");
                totalPriceDisplay.innerText = "Total Price: $" + totalPrice;
            }*/
        </script>
    
        <footer>
            <div class="container-footer">
                <div class="row">
                    <div class="col">
                        <h3>About Us</h3>
                        <p>&copy Abirami Travels</p>
                    </div>

                    <div class="col">
                        <h3>Contact Us</h3>
                        <p>Phone: 075-7709492<br>Email: info@abiramitravels.com</p>
                    </div>

                    <div class="col">
                        <h3>Follow Us</h3>
                        <ul class="social-icons">
                            <li><a href="https://www.facebook.com/login/"><i class="fa fa-facebook"></i></a></li>
                            <li><a href="https://twitter.com/login?lang=en"><i class="fa fa-twitter"></i></a></li>
                            <li><a href="https://www.instagram.com/accounts/edit/"><i class="fa fa-instagram"></i></a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </footer>
    </body>
</html>